(()=>{"use strict";const e=function(){!function(){if(localStorage.getItem("messages")){let e=JSON.parse(localStorage.getItem("messages"));e.forEach((e=>{l(e)})),function(e){let t=m(e);for(let e=0;e<t.length;e++)r(t[e])}(e)}else localStorage.setItem("messages",JSON.stringify([]))}();let e=new WebSocket("wss://fep-app.herokuapp.com/");function l(e){let t=postItemsInTemplate.innerHTML.replace("{{name}}",e.username).replace("{{massage}}",e.message);massages.insertAdjacentHTML("beforeend",t)}function c(e,t){e.send(JSON.stringify({type:"message",payload:{username:""+localStorage.login,message:""+t}}))}function r(e){let t=s.innerHTML.replace("{{user}}",e);users.insertAdjacentHTML("beforeend",t)}function m(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].username);return t=[...new Set(t)],t}(function t(){e=new WebSocket("wss://fep-app.herokuapp.com/"),e.onopen=function(e){0==JSON.parse(localStorage.getItem("messages")).length&&c(e.target,"connected")},e.onclose=()=>{a.checked&&(e=null,setTimeout(t,5e3)),console.log("close")},e.onmessage=e=>{const{payload:t}=JSON.parse(e.data);l(t);let n=JSON.parse(localStorage.getItem("messages"));!function(e,t){e.includes(t.username)||r(t.username)}(m(n),t),n.push(t),localStorage.setItem("messages",JSON.stringify(n))}})(),t.addEventListener("click",(function(){localStorage.clear(),document.location.reload()})),n.addEventListener("click",(function(){""==!o.value.trim()&&c(e,o.value),o.value=""}))},t=(document.getElementById("chat-window"),document.getElementById("logout-button")),n=document.getElementById("button-enter"),o=document.getElementById("input-massage"),a=document.getElementById("scales"),s=document.getElementById("postItemsInUsersTemplate"),l=document.getElementById("input"),c=document.getElementById("login-container"),r=document.getElementById("button"),m=document.querySelector(".container");function u(){c.classList="container-none",m.classList.remove("container-none")}r.addEventListener("click",(function(t){t.preventDefault(),function(){let e=l.value.trim();return""!==e&&void 0!==e}()?(localStorage.setItem("login",l.value),u(),e()):alert("Vvedite login")})),document.addEventListener("DOMContentLoaded",void(localStorage.getItem("login")&&(u(),e())))})();